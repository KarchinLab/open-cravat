<!doctype html>
<html>
<head>
    <title>open-cravat submit</title>
    <script src="websubmit.js"></script>
    <script src="/submit/jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" href="websubmit.css">
    <script src='../store/webstore.js'></script>
    <script>
        $(document).ready(function() {
            websubmit_run();
        });
    </script> 
</head>

<body style='font-family: helvetica;'>

<div id='accountdiv' style='z-index: 3; position: fixed;'>
    <div id='userdiv' style='display: none;'></div>
    <div id='logoutdiv' style='display: none;'>
        <button onclick='changePassword();'>Change password</button>
        <button onclick='logout();'>Logout</button>
        <div id='changepassworddiv' style='display: none; position: absolute; padding: 10px; background-color: white; border: 1px solid black; font-size: 14px;'>
            Old password: <input type='password' id='changepasswordoldpassword' />
            <br />
            New password: <input type='password' id='changepasswordnewpassword' />
            <br />
            Retype new password: <input type='password' id='changepasswordretypenewpassword' />
            <br />
            <button onclick='submitNewPassword();'>Submit</button>
        </div>
    </div>
    <button id='loginsignupbutton' onclick='toggleloginsignupdiv();'>Log in</button>
    <div id='loginsignupdialog' style='display: none; position: fixed; padding: 10px; background-color: white; border: 1px solid black; font-size: 14px; box-shadow: 6px 6px 6px #b5b5b5;'>
        <div id='logindiv' style='display: block;'>
            <span style='font-weight: bold;'>Login:</span>
            <br />
            Email: <input type='text' id='login_username' />
            <br />
            Password: <input type='password' id='login_password' />
            <span style='text-decoration: underline; color: blue; cursor: default;' onclick='forgotPassword();'>Forgot password?</span>
            <br />
            <button onclick='login();'>Login</button> or <span style='text-decoration: underline; color: blue; cursor: default;' onclick='showSignupDiv();'>Sign up</span>
            <div id='forgotpassworddiv' style='display: none;'>
                <br />
                <span style='font-weight: bold;'>Forgot Password:</span>
                <br />
                <div id='forgotpasswordgetquestiondiv'>
                    Email: <input type='text' id='forgotpasswordemail' />
                    <br />
                    <button id='forgotpasswordgetquestionbutton' onclick='getPasswordQuestion();'>Get password question</button>
                </div>
                <div id='forgotpasswordquestionanswerdiv'>
                    Question: <span id='forgotpasswordquestion'></span>
                    <br />
                    Answer: <input type='text' id='forgotpasswordanswer' />
                    <br />
                    <button id='forgotpasswordsubmitbutton' onclick='submitForgotPasswordAnswer();'>Submit</button>
                </div>
            </div>
            <br />
        </div>
        <div id='signupdiv' style='display: none;'>
            <span style='font-weight: bold;'>Sign-up:</span>
            <br />
            Email: <input type='text' id='signupemail' />
            <br />
            Password: <input type='password' id='signuppassword' />
            <br />
            Re-type password: <input type='password' id='signupretypepassword' />
            <br />
            Question: <input type='text' id='signupquestion' />
            <br />
            Answer: <input type='text' id='signupanswer' />
            <br />
            <button id='signupbutton' onclick='signupSubmit();'>Create account</button>
        </div>
        <br />
        <div id='accountmsgdiv' style='color: red;'></div>
        <div style='position: absolute; top: 6px; right: 6px; cursor: default;' onclick='closeLoginSignupDialog();'>X</div>
    </div>
</div>

<div id='pageselect'>
    <div selval='t' value='submitdiv' onclick='changePage("submitdiv");'>
        Jobs 
    </div><div value='storediv' onclick='changePage("storediv");'>
        Store
    </div><div id='settingspageselect' value='settingsdiv' onclick='changePage("settingsdiv");'>
        Settings
    </div>
</div>

<div id='submitdiv' class='appdiv'>
    <div id = 'headerdiv' style='position: fixed; top: 0px; width: 100%; z-index: 1; padding-bottom: 20px; height: 100px; background-color: white; box-shadow: 0px 0px 20px gray; left: 0px; right: 0px;'>
        <div style='position: absolute; left: calc(50% - 180px); bottom: 40px;'>
            <img src='logo.png' style='width: 300px; position: relative; top: 39px;' />
        </div>
        <div style="position: absolute; right: 25px; vertical-align: bottom; bottom: 10px;">
            OpenCRAVAT Version: <span id="curverspan" style="font-family: monospace;"></span>
            <br>
            Latest Version: <span id="latestverspan" style="font-family: monospace;"></span>
            <br>
            <a href="https://github.com/KarchinLab/open-cravat/wiki/Release-Notes" target="_blank">Release notes</a>
            <br>
            <a href="https://github.com/KarchinLab/open-cravat/wiki/Update-Instructions" target="_blank">Update instructions</a>
        </div>
    </div>

    <table><tr><td valign='top' style=''>
    <div id='submitcontentdiv' style='position: relative; top: 120px; display: block;'>
        <br />
        <div id="submit-form" style='overflow-y: auto;'>
            <div class='container'>
                <span class='divtitle'>Variants</span>
                <br />
                <br />
                <table>
                    <tr>
                        <td valign='top' style='border-bottom: 1px solid black; padding-bottom: 20px;'>
                            <table style='width: 100%'><tr><td>
                            Upload a variant file<br />
                            <span style='font-size: 12px;'>(<a href=''>CRAVAT</a> or <a href=''>VCF</a> format)</span>
                            <br />
                            <input type="file" name="input-file" id="input-file" />
                            </td>
                            <td style='text-align: right;'>
                                <select id="assembly-select" size='3'>
                                    <option value="hg38" selected=true>hg38</option>
                                    <option value="hg19">hg19</option>
                                    <option value="hg18">hg18</option>
                                </select>
                            </td></tr></table>
                        </td>
                    </tr><tr>
                        <td valign='top' style='border-bottom: 1px solid black; padding-bottom: 20px; position: relative; padding-top: 20px;'>
                            <div>
                                Type variants
                                <br />
                                <textarea rows="3" cols="60" id="input-text" style='font-size: 12px;' placeholder="Input text"></textarea>
                            </div>
                            <div class='or'>OR</div>
                        </td>
                    </tr><tr>
                        <td valign='top' style='position: relative; padding-top: 20px;'>
                            Try examples:
                            <button value="cravat" class='input-example-button'>CRAVAT Format</button>
                            <button value="vcf" class='input-example-button'>VCF Format</button>
                            <div class='or'>OR</div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div style='margin-top: 14px;'>
                                <span style='vertical-align: top;'>Note: </span>
                                <textarea id='jobnoteinput' cols='50' rows='1' placeholder='Enter a note for the analysis (optional)'></textarea>
                            </div>
                        </td>
                    </tr>
                </table>
                <div class='divbanner'></div>
            </div>
            <div id='annotchoosediv' class='container'>
                <span class='divtitle'>Annotators</span>
                <br />
                <br />
                <br />
                Mouse over an annotator to see details (if the browser is connected to the internet).
                <div id="annotator-select-div"></div>
                <div class='divbanner'></div>
            </div>
        </div>
        <br />

        <div style='text-align: center;'><button id="submit-job-button" style='font-size: 24px; padding: 10px; width: 100%; background-color: #d0d0d0; border-radius: 6px; margin-bottom: 10px;'>Annotate</button></div>
    </div>

    </td><td valign='top' style='padding-left: 20px; width: 100%;'>
    <div id="jobdiv" style='position: relative; top: 120px; display: block;'>
        <br />
            <div style='width: 100%; text-align: right;'>
                <span style='font-style: italic;'></span>
                <span id='jobsdirtext' style='font-family: monospace;'></span>
                <button id="refresh-jobs-table-btn">Refresh Table</button>
            </div>
            <table id="jobs-table" style='width: 100%; border-spacing: 10px;'>
                <thead>
                <tr>
                    <th class='tableheadercell'>Input File</th>
                    <th class='tableheadercell'>Job ID</th>
                    <th class='tableheadercell'>Status</th>
                    <th class='tableheadercell'>Note</th>
                    <th class='tableheadercell'>Genome</th>
                    <th class='tableheadercell'>Result Viewer</th>
                    <th class='tableheadercell'>Download</th>
                    <th class='tableheadercell'>Delete</th>
                </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        <br />
    </div>  
    </td></tr></table>

    <iframe id="download-area" style="display:none;"></iframe>

</div> <!-- submitdiv -->

<div id='storediv' class='appdiv'>
    <div style='position: fixed; top: 0px; width: 100%; z-index: 1; padding-bottom: 20px; height: 100px; background-color: white; box-shadow: 0px 0px 20px gray; left: 0px; right: 0px;'>
        <div style='position: absolute; left: calc(50% - 180px); bottom: 40px;'>
            <img src='logo.png' style='width: 360px; position: relative; top: 39px;' />
        </div>
        <div style='position: absolute; right: 25px; vertical-align: bottom; bottom: 10px;'>
            Modules directory: <span id='modulesdirspan' style='font-family: monospace;'></span>
            <br />
            Module type:
            <select id='typefilter' onchange='updateFilter()' style='font-size: 16px'></select>
            <input type='text' id='namefilter' name='namefilter' placeholder='Search the Store' oninput='updateFilter()' style='font-size: 16px'/>
        </div>
    </div>
    <div id='messagediv' style='position: fixed; width: 100%; text-align: center; color: black; background-color: yellow; font-size: 20px; height: 100px; z-index: 1; display: none;'></div>
    <div id='remotemodulepanels' style='display: flex; flex-wrap: wrap; justify-content: center; position: relative; top: 120px; background-color: white;'></div>
</div> <!-- storediv -->

<div id='settingsdiv' class='appdiv' style='display: none;'>
    <div style='position: fixed; top: 0px; width: 100%; z-index: 1; padding-bottom: 20px; height: 100px; background-color: white; box-shadow: 0px 0px 20px gray; left: 0px; right: 0px;'>
        <div style='position: absolute; left: calc(50% - 180px); bottom: 40px;'>
            <img src='logo.png' style='width: 360px; position: relative; top: 39px;' />
        </div>
    </div>
    <div style='position: relative; top: 120px;'>
        <span>System configuration file:</span><span id='sysconfpathspan'></span>
        <br />
        <textarea id='sysconftextarea' cols='120' rows='30'></textarea>
        <br />
        <button style='font-size: 30px; padding: 11px; background-color: #d6ecff;' onclick='updateSystemConf();'>Update</button>
        <button style='font-size: 30px; padding: 11px; background-color: #d6ecff;' onclick='resetSystemConf();'>Reset</button>
    </div>
</div> <!-- settingsdiv -->

</body>
</html>
